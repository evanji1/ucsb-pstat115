<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>PSTAT 115: Bayesian Data Analysis</title>
    <meta charset="utf-8" />
    <meta name="author" content="Professor Rodrigo Targino" />
    <script src="introduction_files/header-attrs-2.16/header-attrs.js"></script>
    <link href="introduction_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan_style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# PSTAT 115: Bayesian Data Analysis
]
.author[
### Professor Rodrigo Targino
]
.date[
### 22-Sep-2022
]

---






### Class Resources 
__Required Textbook__

- Bayes Rules: https://www.bayesrulesbook.com/

__Course Pages__

- Nectir for course related questions and discussion: https://app.nectir.io/group/ucsb/pstat-115-f22

- Gradescope: https://www.gradescope.com/courses/445614

- GauchoSpace: https://gauchospace.ucsb.edu/courses/course/view.php?id=33131

---

### Grades

- 35% - expect approximately 6 homeworks 

- 20% - Midterm (October 27)

- 15% - Quizzes + Participation

- 30% - Final exam (December 8)

---

### Homework

- There will be approximately 6 homeworks (35% of your grade total)

- You will typically have 1-2 weeks to complete the homeworks

- You are allowed to work with a partner

  + Add partners name to your assignment

- Every student *must* submit their own assignment on gradescope

- Homework turned in within 24 hrs after the deadline without prior approval will receive a 10 pt deduction (out of 100)

- Homework will not be accepted more than 24 hrs late.

---

### Homework submission format

- All code must be written to be reproducible in Rmarkdown

- All derivations can be done in any format of your choosing (latex, written by hand) but must be legible and _must be integrated into your Rmarkdown pdf_.

- All files must be zipped together and submitted to Gradescope

- Ask a TA _early_ if you have problems regarding submissions. 

---

### Software and Deliverables

__Software__

- [R](http://cran.r-project.org/) ([R studio](http://www.rstudio.com/))



__Homeworks submission format__

- Electronic submission via GauchoSpace

- [R markdown code](http://rmarkdown.rstudio.com/)

- Generated PDF file

- Any supplementary files (e.g. write up for math problems)

All should be zipped up and we should be able to run it to obtain identical PDF
file

---

### Labs and Quizzes

- There will be a handful of "pop" quizzes throughout the quarter.  

- The quizzes will be on Gradescope.  

- You will have 10 minutes to take the quiz any time within 24 hours of the announcement.

- The quizzes will be given on lecture days

- There are no makeups, but the lowest quiz grade will be dropped from your final score.

- Quizzes will be multiple choice and will test your comprehension of the basic concept.

- Participation includes lecture attendance, section attendance, and nectir posts.

---

### Class Policies

- All questions should be posted on nectir, _not by email_ (unless they are personal or grade-related)

---

### RStudio Cloud Service


- Log on to [pstat115.lsit.ucsb.edu](https://pstat115.lsit.ucsb.edu)
    + Cloud based rstudio service
    + Log in with your UCSB NetID

- Use [tinyurl.com/2hpr9mpj](tinyurl.com/2hpr9mpj) to sync new material (BOOKMARK THIS)
  
- Make sure you can write and compile an [R
  markdown](http://rmarkdown.rstudio.com) (`Rmd`) document online
  
- Text formatting is minimal but
  [syntax](http://rmarkdown.rstudio.com/authoring_pandoc_markdown.html) is
  simple
---

### Markdown and mathematical formulas
The text inserted between two `$` signs will be interpreted as a Latex instruction, e.g.
`$x$`

Code                                       | Rendered math 
-------------------------------------------|-------------------------------------------
`$x$`                                      | `\(x\)`
`$\theta$`                                 | `\(\theta\)`
`$x_i^2$`                                  | `\(x_i^2\)`
`$\frac{1}{n}\sum_{i=1}^n x_i$`            | `\(\frac{1}{n} \sum_{i=1}^n x_i\)`
`$\frac{1}{n}\sum_{i=1}^n (x_i-\bar x)^2$` | `\(\frac{1}{n} \sum_{i=1}^n (x_i - \bar x)^2\)`

Rmarkdown and Latex resources:
&lt;li&gt;&lt;a href="http://rmarkdown.rstudio.com/lesson-1.html" target="_blank"&gt;Introduction to RMarkdown&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://wch.github.io/latexsheet/" target="_blank"&gt;Latex cheat sheet&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.andy-roberts.net/writing/latex" target="_blank"&gt;Introduction to Latex&lt;/a&gt;&lt;/li&gt;

---

### Other R resources

- Cheatsheets: [https://www.rstudio.com/resources/cheatsheets/](https://www.rstudio.com/resources/cheatsheets/)

- _An Introduction to R_ - Venables and Smith
  
    http://cran.r-project.org/doc/manuals/R-intro.pdf

- _Using R for Introductory Statistics_ - John Verzani

    http://cran.r-project.org/doc/contrib/Verzani-SimpleR.pdf

- _R Markdown reference_ - https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf

- Probability cheatsheet in resources folder of cloud environment
---
class: center, middle

# What is Bayesian statistics?
---
class: center, middle
# What is the version of statistics you already know?
---
### Frequentist statistics

&lt;center&gt; What you learned in PSTAT 120B &lt;/center&gt;
&lt;br&gt;

- Associated with the _frequentist_ interpretation of probability

  + For any given event, only one of two possibilities may hold: it occurs or it does not.

  + The _frequency_ of an event (in repeated experiments) is the _probability_ of the event

---
### Frequentist probability
&lt;center&gt;The probability of a coin landing on heads is 50%&lt;/center&gt;
&lt;img src="introduction_files/figure-html/unnamed-chunk-1-1.png" width="50%" style="display: block; margin: auto;" /&gt;
&lt;center&gt;The long run fraction of heads is 50%&lt;/center&gt;
---
### Frequentist statistics

&lt;center&gt; What you learned in PSTAT 120B &lt;/center&gt;
&lt;br&gt;

- Null Hypothesis Significant Testing (NHST) and Confidence Intervals
    + Frequentist uncertainty premised on imaginary resampling of data
    
    + Example: If the null model is true, and I re-run the experiment many times, how often will I reject?

---

### Confidence intervals

I have a `\(95\%\)` confidence interval for a parameter `\(\theta\)`.  What does this mean?
&lt;!-- &gt;- `\(Pr(l(Y) &lt; \theta &lt; u(Y)\mid \theta) = 0.95\)` --&gt;
&lt;!-- &gt;- `\(Y\)` is a random so `\(l(Y)\)` and `\(u(y)\)` is as well! --&gt;
&lt;!-- &gt;- `\(\theta\)` is an unknown constant --&gt;
&lt;!-- + Example: If I re-run the experiment many times what fraction of times will the interval cover the true parameter? --&gt;
&lt;img src="introduction_files/figure-html/unnamed-chunk-2-1.png" width="55%" style="display: block; margin: auto;" /&gt;
We expect `\(0.05 \times 50 = 2.5\)` of the intervals to _not_ cover the true parameter, `\(p = 0.6\)`, on average

---

### Falsification

&lt;img src="images/blackswan.jpg" width="60%" style="display: block; margin: auto;" /&gt;
&lt;br&gt;
&lt;br&gt;
`\(H_0:\)` "All swans are white" vs `\(H_A:\)` "not all swans are white".

---

### Falsification

&lt;img src="images/woodpecker.jpg" width="30%" style="display: block; margin: auto;" /&gt;


`\(H_0:\)` "The Ivory-billed Woodpecker is extinct"

---

### Falsification

&lt;img src="images/blackswan.jpg" width="60%" style="display: block; margin: auto;" /&gt;
&lt;br&gt;
&lt;br&gt;
`\(H_0:\)` "Black swans are rare"

---

### Falsification

- Is an observation real or spurious?

    + Importance of measurement error

    + Natural phenomena are usually continuous in nature
&lt;br&gt;

- Falsification requires consensus more than logic

    + Scientific communities argue toward consensus

    + Science is messy!
---
### Significance Testing Flowchart

&lt;img src="images/frequentist_flow_chart.png" width="90%" style="display: block; margin: auto;" /&gt;

---

### Alternative: focus on modeling!

- A statistical model represents a set of assumption about how the data was generated.  

- Models can still be used to develop statistical tests. 

- Can also be used to make predictions or forecasts and describe sources of variability.

- Can (and should) be continuously refined and extended!

---

### All models are wrong

&lt;img src="images/all-models-wrong.jpg" width="75%" style="display: block; margin: auto;" /&gt;

[https://en.wikipedia.org/wiki/All_models_are_wrong](Wikipedia)

---

### Frequentist probability

&lt;img src="introduction_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;" /&gt;

---

###  Win probability

&lt;img src="images/win_probability.png" width="60%" style="display: block; margin: auto;" /&gt;
&lt;center&gt;source: fivethirtyeight.com&lt;/center&gt;

---
###  Win probability

&lt;img src="images/election_win_prob.png" width="70%" style="display: block; margin: auto;" /&gt;
&lt;center&gt;source: fivethirtyeight.com&lt;/center&gt;

---

### Bayesian probability

&lt;img src="images/theory_of_probability.jpg" width="300px" height="400px" style="display: block; margin: auto;" /&gt;

&lt;center&gt;Bruno de Finetti begean his book on probability with:&lt;/center&gt;
&lt;center&gt;"PROBABILITY DOES NOT EXIST"&lt;/center&gt;
---
### Bayesian probability

- de Finetti is arguing that probability is about _belief_

  + Probability doesn't exist in an _objective_ sense

  + "The coin is fair" means _I believe_ that its equally likely to be heads or tails.

  + "Hillary Clinton has a 71% chance to win" reflects a belief, since the election happens only once

- Rarely, if ever, get _true_ replications to estimate frequentist probabilities

- Bayesian idea: focus statistical practice around belief about parameters

---
### Bayesian probability

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

&gt; "The terms _certain_ and _probable_ describe the various degrees 
&gt; of rational belief about a proposition which different amounts 
&gt; of knowledge authorise us to entertain. All propositions are true 
&gt; or false, but the knowledge we have of them depends on our circumstances
&gt;
&gt; &lt;footer&gt;--- John M Keynes&lt;/footer&gt;

---

### Perceptions of Probability

&lt;img src="images/perceptions.png" width="70%" style="display: block; margin: auto;" /&gt;
source: https://github.com/zonination/perceptions
---

### Why Bayesian statistics?

- Classic statistical toolbox may not be appropriate for all settings.  

    + Inflexible and fragile
    + e.g. what if the assumptions of the test don't hold?

- Bayesian statistics provides a procedure for building our own tests / tools.

    + Design, build and refine procedures for you own models.

- A variety of powerful tools for inference with computer simulation

- Philosophy of science: quantifying degrees of belief often a more useful perspective than falsification

---

### Setup

- The _sample space_ `\(\mathcal{Y}\)` is the set of all possible datasets.  
    + `\(Y\)` is a random variable with support in `\(\mathcal{Y}\)`
    + We observe one dataset `\(y\)` from which we hope to learn about the world.  

- The _parameter space_ `\(\Theta\)` is the set of all possible parameter values `\(\theta\)`

- `\(\theta\)` encodes the population characteristics that we want to learn about!

---

### Three steps of Bayesian data analysis

1. Construct a plausible probability model governed by parameters `\(\theta\)`

    + This includes specifying your belief about `\(\theta\)` before seeing data (_the prior_)

2. Condition on the observed data and compute _the posterior_ distribution for `\(\theta\)`

3.  Evaluate the model fit, revise and extend.  Then repeat.

---
### Bayesian Inference in a Nutshell

1.  The _prior distribution_ `\(p(\theta)\)` describes our belief about the true population characteristics, for each value of `\(\theta \in \Theta\)`.

2.  Our _sampling model_ `\(p(y\mid \theta)\)` describes our belief about what data we are likely to observe if `\(\theta\)` is true.  

3.  Once we actually observe data, `\(y\)`, we update our beliefs about `\(\theta\)` by computing _the posterior distribution_ `\(p(\theta \mid y)\)`.  We do this with Bayes' rule!

&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp; **Key difference: `\(\theta\)` is random!**

---
### Bayes' Rule

$$ P(A \mid B) = \frac{P(B \mid A)P(A)}{P(B)}$$

- `\(P(A \mid B)\)` is the conditional probability of A given B
- `\(P(B \mid A)\)` is the conditional probability of B given A
- `\(P(A)\)` and `\(P(B)\)` are called the marginal probability of A and B (unconditional)
---

### Bayes' Rule for Bayesian Statistics

$$ P(\theta \mid y) = \frac{P(y \mid \theta)P(\theta)}{P(y)}$$


- `\(P(\theta \mid y)\)` is the posterior distribution

- `\(P(y \mid \theta)\)` is the likelihood

- `\(P(\theta)\)` is the prior distribution

- `\(P(y) = \int_\Theta p(y\mid \tilde \theta)p(\tilde \theta) d\tilde \theta\)` is the model evidence 

---

### Bayes' Rule for Bayesian Statistics

`$$P(\theta \mid y) = \frac{P(y \mid \theta)P(\theta)}{P(y)}\propto P(y \mid \theta)P(\theta)$$`

- Start with a subjective belief (prior)

- Update it with evidence from data (likelihood)

- Summarize what you learn (posterior)

---

### Example: Estimating COVID Infection Rates 

- We need to estimate the prevalence of a COVID in Isla Vista

- Get a small random sample of 20 individuals to check for infection

&lt;img src="images/covid.jpg" width="70%" style="display: block; margin: auto;" /&gt;

---

### Example: Estimating Infection Rates 

- `\(\theta\)` represents the population fraction of infected

- `\(Y\)` is a random variable reflecting the number of infected in the sample

- `\(\Theta = [0,1] \quad \mathcal{Y} = \{0,1 , \ldots , 20 \}\)`

- Sampling model: `\(Y \sim \text{Binom}(20, \theta)\)`

---
### Example: Estimating Infection Rates 

&lt;img src="introduction_files/figure-html/unnamed-chunk-14-1.png" width="50%" style="display: block; margin: auto;" /&gt;

---

### Example: Estimating Infection Rates 

- Assume _a priori_ that the population rate is low 
        
    + The infection rate in comparable cities ranges from about 0.05 to 0.20
    
- Assume we observe `\(Y = 0\)` infected in our sample

- What is our estimate of the true population fraction of infected individuals?

---

## Example: Estimating Infection Rates 

&lt;img src="introduction_files/figure-html/unnamed-chunk-15-1.png" width="50%" style="display: block; margin: auto;" /&gt;

---
### Tentative syllabus

- One parameter models (binomial, poisson, and normal)

- Monte Carlo methods (i.e. simulation-based inference)

- Markov chain Monte Carlo (MCMC)

- Hierarchical modeling

- An introduction to probabilistic programming

---
### Assignment

- Check Nectir, bookmark important links

- Lab starts next Wednesday (September 28)

- Start reviewing probability cheat sheet!

- Read chapters 1 and 2 of Bayes Rules
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightLines": true,
"ratio": "4:3"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
